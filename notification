function sendTodayBirthday() {
  var lastRow = sortList.getLastRow();
  var range = sortList.getRange(2, 1, lastRow - 1, 4);  // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö A, B, C, D
  var data = range.getValues();

  var today = new Date();
  var todayMonth = today.getMonth();
  var todayDate = today.getDate();
  
  
  for (var i = 0; i < data.length; i++) {
    var birthday = data[i][1];
    var birthdayMonth = birthday.getMonth();
    var birthdayDate = birthday.getDate();
    let comment = (data[i][2].length > 0) ? ("\n\n–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: " + data[i][2]) : "";
    let username = (data[i][3].length > 0) ? (data[i][3]) : "";


    if (todayMonth === birthdayMonth && todayDate === birthdayDate) {
    var name = data[i][0];  
    var message = "üéâ –Æ—Ö—É—É—É! \n\n–°–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –ø—Ä–∞–∑–¥–Ω—É–µ—Ç " + name + ". " + username + "\n\n–ù–∞–ø—Ä–∞–≤–ª—è–µ–º —Å–≤–æ–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è !" + comment ;
      
      sendMessageToUsers(message);
    }
  }
}


function sendMonthBirthdays() {
  var lastRow = sortList.getLastRow();
  var range = sortList.getRange(2, 1, lastRow - 1, 4);  // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö A, B, C, D
  var data = range.getValues();
  var today = new Date();
  var currentMonth = today.getMonth();
  var birthdays = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è
  var hasBirthdayMounth = false; // –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –≤ false
  
  for (var i = 0; i < data.length; i++) {
    var name = data[i][0]; 
    var birthday = data[i][1];
    var birthdayMonth = birthday.getMonth();
    var birthdayDate = birthday.getDate();
  if (birthdayMonth === currentMonth) {
    birthdays.push(birthdayDate + " " + getMonthName(birthdayMonth, 0) + " ‚Äî " + name); // –î–æ–±–∞–≤–∏—Ç—å –∏–º—è –∏ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –≤ –º–∞—Å—Å–∏–≤
    }
    
  }
  
  if (birthdays.length > 0) {
        var message = "üî∏ –î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ " + getMonthName(currentMonth, 2) + ":\n\n" + birthdays.join("\n"); // –°–æ–±—Ä–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–º–µ–Ω–∏ –∏ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏–π

    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram-–±–æ—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è API Bot
    sendMessageToUsers(message);
    hasBirthdayMounth = true; // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥, —á—Ç–æ –±—ã–ª –Ω–∞–π–¥–µ–Ω —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è —Å–µ–≥–æ–¥–Ω—è
  }

  if (!hasBirthdayMounth) { // –ï—Å–ª–∏ –Ω–µ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏–π —Å–µ–≥–æ–¥–Ω—è
    var Xmessage = "üòì –û–±—ã—á–Ω—ã–π –º–µ—Å—è—Ü, –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∞–∑–¥–Ω—É–µ—Ç –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è.";
    sendMessageToUsers(Xmessage)
  }
}



function send4dayNotification() {
  var lastRow = sortList.getLastRow();
  var range = sortList.getRange(2, 1, lastRow - 1, 3); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö A, B, C
  
  var today = new Date();
  var todayMonth = today.getMonth();
  var todayDate = today.getDate();


  var data = range.getValues();
  
  for (var i = 0; i < data.length; i++) {
    var birthday = data[i][1];
    var birthdayMonth = birthday.getMonth();
    var birthdayDate = birthday.getDate();
    
    if (todayMonth === birthdayMonth && todayDate + 4 === birthdayDate) {
      var name = data[i][0];  
      var message = "üí• –ô–æ—É –ô–æ—É!\n\n" + birthdayDate + " " + getMonthName(birthdayMonth, 0) + " " + name + " –ø—Ä–∞–∑–¥–Ω—É–µ—Ç –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è " + "! \n\n–ù–∞–¥–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∏ –ø–æ–∑–¥—Ä–∞–≤–∏—Ç—å!";
      
      sendMessageToUsers(message);
    }
  }
}
